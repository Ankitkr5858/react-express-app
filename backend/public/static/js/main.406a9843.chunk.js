(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{28:function(e,t,r){e.exports=r(40)},39:function(e,t,r){},40:function(e,t,r){"use strict";r.r(t);r(29);var n=r(0),a=r.n(n),o=r(15),l=r.n(o),i=r(2),c=r(3),u=r(8),s=r(9),m=r(11),d=r(10),h=r(5),f=r(1),p={LOGIN_SUCCESS:"LOGIN_SUCCESS",LOGIN_FAILURE:"LOGIN_FAILURE",OTP_SUCCESS:"OTP_SUCCESS",OTP_FAILURE:"OTP_FAILURE",LOGOUT:"USERS_LOGOUT"},E={PROFILE_UPDATE_SUCCESS:"PROFILE_UPDATE_SUCCESS",PROFILE_UPDATE_FAILURE:"PROFILE_UPDATE_FAILURE",REFERRAL_CODE_PERSISTED:"REFERRAL_CODE_PERSISTED"},b=r(6),v=function(){var e=JSON.parse(localStorage.getItem("user")||"{}");return e.accessToken?{Authorization:"Bearer ".concat(e.accessToken)}:{}},O=function(e){return e.ok?e.json():e.json().then(Promise.reject.bind(Promise))},g=new(function(){function e(){Object(i.a)(this,e)}return Object(c.a)(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fetch("/api/".concat(e),{headers:Object(b.a)({},v(),{},t)}).then(O)}},{key:"post",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return fetch("/api/".concat(e),{method:"POST",headers:Object(b.a)({},v(),{"Content-Type":"application/json"},r),body:JSON.stringify(t)}).then(O)}},{key:"patch",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return fetch("/api/".concat(e),{method:"PATCH",headers:Object(b.a)({},v(),{"Content-Type":"application/json"},r),body:JSON.stringify(t)}).then(O)}}]),e}());function S(){return JSON.parse(localStorage.getItem("user"))}var C={login:function(e){return g.post("login",{email:e}).then((function(e){return localStorage.setItem("user",JSON.stringify(e)),e}))},loginWithOTP:function(e,t){return g.post("otp",{email:e,otp:t}).then((function(e){return e=Object(b.a)({},S(),{},e),localStorage.setItem("user",JSON.stringify(e)),e}))},logout:function(){localStorage.removeItem("user")},update:function(e){return g.patch("user/profile",e).then((function(e){return e=Object(b.a)({},S(),{},e),localStorage.setItem("user",JSON.stringify(e)),e}))},userData:S},R="DISPLAY_ERROR",y="DELETE_ERROR";function j(e){return{type:R,error:e}}function P(){return{type:y}}var N={displayError:j,deleteError:P},L=r(4),T=Object(L.a)();var _={login:function(e){return function(t){C.login(e).then((function(e){t({type:p.LOGIN_SUCCESS,user:e}),P(),T.push("/otp")}),(function(e){t({type:p.LOGIN_FAILURE,error:e}),t(j(e.error||"Something went wrong"))}))}},logout:function(){return C.logout(),{type:p.LOGOUT}},logoutAndRedirect:function(){return T.push("/login"),{type:p.LOGOUT}},loginWithOTP:function(e){return function(t){var r=C.userData();C.loginWithOTP(r.email,e).then((function(e){var n=e.accessToken;t({type:p.OTP_SUCCESS,accessToken:n}),P(),r.isProfileComplete?T.push("/profile"):T.push("/profile/edit")}),(function(e){t({type:p.OTP_FAILURE,error:e}),t(j(e.error||"Something went wrong"))}))}},updateProfile:function(e){return function(t){C.update(e).then((function(e){t({type:E.PROFILE_UPDATE_SUCCESS,user:e}),P(),T.push("/profile")}),(function(e){t({type:E.PROFILE_UPDATE_FAILURE,error:e}),t(j(e.error||"Something went wrong"))}))}},persistReferralCode:function(e){return{type:E.REFERRAL_CODE_PERSISTED,invitedByReferralCode:e}}},I=function(e){Object(s.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).props.logout(),n.state={email:""},n.handleChange=n.handleChange.bind(Object(h.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(h.a)(n)),n}return Object(c.a)(r,[{key:"handleChange",value:function(e){var t=e.target,r=t.name,n=t.value;this.setState(Object(d.a)({},r,n))}},{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.state.email;t&&this.props.login(t)}},{key:"render",value:function(){var e=this.state.email,t=this.props.error;return a.a.createElement("div",null,a.a.createElement("h2",null,"Login"),t&&a.a.createElement("div",{className:"alert alert-danger"},t),a.a.createElement("form",{name:"form",onSubmit:this.handleSubmit},a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{htmlFor:"email"},"Email"),a.a.createElement("input",{type:"text",className:"form-control",required:!0,name:"email",value:e,onChange:this.handleChange})),a.a.createElement("div",{className:"form-group"},a.a.createElement("button",{className:"btn btn-primary"},"Login"))))}}]),r}(a.a.Component);var U={login:_.login,logout:_.logout},A=Object(f.b)((function(e){return{error:e.errorReducer.error}}),U)(I),F=function(e){Object(s.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).state={otp:""},n.handleChange=n.handleChange.bind(Object(h.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(h.a)(n)),n}return Object(c.a)(r,[{key:"handleChange",value:function(e){var t=e.target,r=t.name,n=t.value;this.setState(Object(d.a)({},r,n))}},{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.state.otp;t&&this.props.loginWithOTP(t)}},{key:"render",value:function(){var e=this.state.otp,t=this.props.error;return a.a.createElement("div",null,a.a.createElement("h2",null,"OTP"),a.a.createElement("p",null,"We have sent you an email with One Time Password. Please, enter it below in order to login."),t&&a.a.createElement("div",{className:"alert alert-danger"},t),a.a.createElement("form",{name:"form",onSubmit:this.handleSubmit},a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{htmlFor:"otp"},"One Time Password"),a.a.createElement("input",{type:"text",className:"form-control",required:!0,name:"otp",value:e,onChange:this.handleChange})),a.a.createElement("div",{className:"form-group"},a.a.createElement("button",{className:"btn btn-primary"},"Login"))))}}]),r}(a.a.Component);var k={loginWithOTP:_.loginWithOTP,logout:_.logout},D=Object(f.b)((function(e){return{error:e.errorReducer.error}}),k)(F),w=r(17),B=function(e){Object(s.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).onLogout=n.onLogout.bind(Object(h.a)(n)),n}return Object(c.a)(r,[{key:"onLogout",value:function(e){e.preventDefault(),this.props.logoutAndRedirect()}},{key:"render",value:function(){var e=this.props.user;return a.a.createElement("div",null,a.a.createElement("h2",null,"User profile"),a.a.createElement("dl",null,a.a.createElement("dt",null,"Email"),a.a.createElement("dd",null,e.email),a.a.createElement("dt",null,"First name"),a.a.createElement("dd",null,e.firstName),a.a.createElement("dt",null,"Last name"),a.a.createElement("dd",null,e.lastName),a.a.createElement("dt",null,"You can invite your friends by the following link:"),a.a.createElement("dd",null,"".concat(window.location.origin,"/invite/").concat(this.props.user.referralCode)),a.a.createElement("div",{className:"btn-group",role:"group"},a.a.createElement(w.a,{className:"btn btn-primary",to:"/profile/edit"},"Edit Profile "),a.a.createElement("button",{className:"btn btn-secondary",onClick:this.onLogout},"Logout"))))}}]),r}(a.a.Component);var G={logoutAndRedirect:_.logoutAndRedirect},J=Object(f.b)((function(e){return{user:e.authenticationReducer.user}}),G)(B),x=function(e){Object(s.a)(r,e);var t=Object(u.a)(r);function r(e){var n;Object(i.a)(this,r),n=t.call(this,e);var a=e.invitedByReferralCode,o=Object.assign({},n.props.user);return a&&(o.invitedByReferralCode=a),n.state={user:o},n.handleChange=n.handleChange.bind(Object(h.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(h.a)(n)),n}return Object(c.a)(r,[{key:"handleChange",value:function(e){var t=e.target,r=t.name,n=t.value;this.setState({user:Object(b.a)({},this.state.user,Object(d.a)({},r,n))})}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.updateProfile(this.state.user)}},{key:"render",value:function(){var e=this.state.user,t=this.props.error;return a.a.createElement("div",null,a.a.createElement("h2",null,"Update Profile"),t&&a.a.createElement("div",{className:"alert alert-danger"},t),a.a.createElement("form",{name:"form",onSubmit:this.handleSubmit},a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{htmlFor:"firstName"},"First name"),a.a.createElement("input",{type:"text",className:"form-control",required:!0,name:"firstName",value:e.firstName||"",onChange:this.handleChange})),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{htmlFor:"lastName"},"Last name"),a.a.createElement("input",{type:"text",className:"form-control",required:!0,name:"lastName",value:e.lastName||"",onChange:this.handleChange})),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{htmlFor:"invitedByReferralCode"},"Referral code"),a.a.createElement("input",{type:"text",className:"form-control",name:"invitedByReferralCode",value:e.invitedByReferralCode||"",onChange:this.handleChange})),a.a.createElement("div",{className:"form-group"},a.a.createElement("button",{className:"btn btn-primary"},"Save"))))}}]),r}(a.a.Component);var W={updateProfile:_.updateProfile},q=Object(f.b)((function(e){return{user:e.authenticationReducer.user,error:e.errorReducer.error,invitedByReferralCode:e.referralCodeReducer.invitedByReferralCode}}),W)(x),Y=r(27);var z=Object(f.b)((function(e){return{user:e.authenticationReducer.user}}),{})((function(e){var t=e.component,r=e.user,n=Object(Y.a)(e,["component","user"]);return a.a.createElement(m.b,Object.assign({},n,{render:function(e){return r&&r.accessToken?a.a.createElement(t,e):a.a.createElement(m.a,{to:{pathname:"/login",state:{from:e.location}}})}}))})),H=(r(39),function(e){Object(s.a)(r,e);var t=Object(u.a)(r);function r(e){var n;Object(i.a)(this,r);var a=(n=t.call(this,e)).props.match.params.referralCode;return n.props.persistReferralCode(a),n}return Object(c.a)(r,[{key:"render",value:function(){return a.a.createElement(A,null)}}]),r}(a.a.Component));var M={persistReferralCode:_.persistReferralCode},K=Object(f.b)((function(e){return{}}),M)(H),Q=function(e){Object(s.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(i.a)(this,r),n=t.call(this,e),T.listen((function(e,t){n.props.deleteError()})),n}return Object(c.a)(r,[{key:"render",value:function(){return a.a.createElement("div",{className:"jumbotron"},a.a.createElement("div",{className:"container text-center"},a.a.createElement("div",{className:"jumbotron-card text-center"},a.a.createElement(m.c,{history:T},a.a.createElement(m.d,null,a.a.createElement(m.b,{path:"/login",component:A}),a.a.createElement(m.b,{path:"/otp",component:D}),a.a.createElement(m.b,{path:"/profile/edit",component:q}),a.a.createElement(z,{path:"/profile",component:J}),a.a.createElement(m.b,{path:"/invite/:referralCode",component:K}),a.a.createElement(m.a,{from:"*",to:"/login"}))))))}}]),r}(a.a.Component);var V={deleteError:N.deleteError},X=Object(f.b)((function(e){return{}}),V)(Q),Z=r(12),$=r(26),ee=JSON.parse(localStorage.getItem("user")),te=ee?{user:ee}:{};function re(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.user,a=t.accessToken,o=t.invitedByReferralCode;switch(r){case p.LOGIN_SUCCESS:return{user:n};case p.OTP_SUCCESS:return{user:Object(b.a)({},e.user,{accessToken:a})};case p.LOGOUT:return{};case E.REFERRAL_CODE_PERSISTED:return Object(b.a)({},e,{invitedByReferralCode:o});case E.PROFILE_UPDATE_SUCCESS:return{user:Object(b.a)({},e.user,{},n)};default:return e}}var ne={error:null};function ae(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=t.invitedByReferralCode;switch(t.type){case E.REFERRAL_CODE_PERSISTED:return{invitedByReferralCode:r};case E.PROFILE_UPDATE_SUCCESS:return{};default:return e}}var oe=Object(Z.c)({authenticationReducer:re,errorReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne,t=arguments.length>1?arguments[1]:void 0,r=t.error,n=t.type;return n===R?{error:r}:n===y?{}:e},referralCodeReducer:ae}),le=Object(Z.d)(oe,Object(Z.a)($.a));l.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(f.a,{store:le},a.a.createElement(X,null))),document.getElementById("root"))}},[[28,1,2]]]);
//# sourceMappingURL=main.406a9843.chunk.js.map